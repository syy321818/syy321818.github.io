---
title: "Fix Error 6 (Overflow) When Summing Large Arrays in Excel VBA"
date: 2025-12-10 12:45:56
tags:
  - VBA
  - Troubleshooting
  - Runtime Error 6
  - Excel Automation
categories:
  - VBA Error Encyclopedia
description: "Resolve Excel VBA Runtime Error 6 'Overflow' when summing large numeric arrays by switching to Long or Double data types."
keywords: [Excel VBA, Runtime Error 6, fix Overflow error, large array sum vba]
---

## The Error

- **Error Code:** Runtime Error 6  
- **Error Message:** "Overflow"  
- **The Scenario:**  
  Your VBA macro fails when summing values in a loop where the total exceeds 32,767 (for Integer variables) or 2,147,483,647 (for Long) with certain operations. Common when aggregating:
  - Large datasets in financial models  
  - Scientific data exceeding 2^15  
  - Accidentally using `Integer` instead of `Long`

## The Root Cause

VBA throws Error 6 when a variable exceeds its declared capacity:
- **Default Trap:** Implicit or explicit `Integer` variables cap at 32,767  
- **Hidden Culprit:** Even `Long` variables can overflow with multiplication/division  
- **Special Case:** `Currency` type fails past 922,337,203,685,477.5807  

``

## The Fix

### Method 1: The Quick Fix
Change variable declaration to `Long` or `Double`:
```vba
Dim grandTotal As Double  ' Instead of Integer
grandTotal = 0
For i = 1 To 100000
    grandTotal = grandTotal + Cells(i, 1).Value
Next i
```

### Method 2: The Robust Fix
Add type checks and error handling:
```vba
Function SafeSum(rng As Range) As Variant
    On Error GoTo ErrHandler
    Dim total As Double, cell As Range
    For Each cell In rng
        If IsNumeric(cell.Value) Then 
            total = total + CDbl(cell.Value)
        End If
    Next
    SafeSum = total
    Exit Function
    
ErrHandler:
    SafeSum = CVErr(xlErrNum)  ' Returns #NUM! to Excel
End Function
```
**Why this works:**  
- `Double` handles values up to 1.8E+308  
- `CDbl()` prevents type coercion errors  
- Error handling returns Excel-compatible results  

## Prevention

1. **Banish Integer** - Always declare counters/sums as `Long` or `Double`  
2. **Force Explicit Types** - Use `Option Explicit` to catch undeclared variables  
3. **Array Math Alternative** - For extreme cases, leverage `WorksheetFunction.Sum()`:
```vba
' 3x faster for 1M+ rows
grandTotal = Application.Sum(Sheets("Data").Range("A1:A1000000")) 
```

4. **Audit Loops** - Add overflow checks in critical paths:
```vba
If total > 2E+307 Then  ' 80% of Double's limit
    Err.Raise vbObjectError + 1, "SumOverflow", "Total nearing Double limit"
End If
