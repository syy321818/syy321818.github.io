---
title: "Fix Error 6 (Overflow) When Summing Large Columns with Integer Variables"
date: 2025-12-10 12:47:05
tags:
  - VBA
  - Troubleshooting
  - Runtime Error 6
  - Excel Automation
categories:
  - VBA Error Encyclopedia
description: "Fix Excel VBA Runtime Error 6 'Overflow' when summing large columns using Integer variables. Includes robust solutions."
keywords: [Excel VBA, Runtime Error 6, fix Overflow error in excel, large column sum vba]

---

## The Error

- **Error Code:** Runtime Error 6
- **Error Message:** "Overflow"
- **The Scenario:** This error occurs when looping through datasets exceeding 32,767 rows while using `Integer` variables for summation or counting.

Example triggering code:
```vba
Sub SumColumn_Broken()
    Dim total As Integer ' <- Culprit!
    Dim i As Long
    
    For i = 1 To 50000
        total = total + Cells(i, 1).Value
    Next i
End Sub
```

## The Root Cause

VBA `Integer` variables have a maximum value of 32,767. When the accumulated sum exceeds this limit (or when processing >32,767 rows), an overflow occurs. This is especially problematic when:
1. Working with modern Excel datasets (>1M rows)
2. Using legacy code that predates larger spreadsheets
3. Copying code examples that use `Integer` unnecessarily

``

## The Fix

### Method 1: The Quick Fix
Replace `Integer` with `Long`:
```vba
Dim total As Long ' <- Fixes the overflow
```

### Method 2: The Robust Fix
Add error handling and explicit typing:
```vba
Sub SumColumn_Fixed()
    Dim total As Currency ' Best for monetary values
    Dim i As Long
    Dim cellVal As Variant
    
    On Error GoTo ErrorHandler
    
    For i = 1 To 50000
        cellVal = Cells(i, 1).Value
        If IsNumeric(cellVal) Then
            total = total + CCur(cellVal)
        End If
    Next i
    
Exit Sub
ErrorHandler:
    MsgBox "Error " & Err.Number & ": " & Err.Description & vbCrLf & _
           "Failed at row " & i, vbCritical
End Sub
```

**Why this works:**
- `Long` variables handle up to 2,147,483,647
- `Currency` type is ideal for financial calculations
- Error handling catches other potential issues

## Prevention

1. **Always use `Long` instead of `Integer`** in modern VBA
2. **Validate data types** before mathematical operations
3. **Consider `Currency`** for financial calculations
4. **Test edge cases** with your expected maximum dataset size

```vba
' Good practice declaration for counters/sums
Dim rowCounter As Long
Dim grandTotal As Currency
