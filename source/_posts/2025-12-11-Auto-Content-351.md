---
title: Fixing Runtime Error 91 "Object Variable Not Set" in Excel VBA When Accessing Worksheet Ranges
date: 2025-12-10 20:21:34
tags:
  - VBA
  - Troubleshooting
  - Error 91
  - Excel Fixes
categories:
  - VBA Error Encyclopedia
description: Step-by-step solution for Excel VBA Runtime Error 91 when attempting to access worksheet ranges without proper object initialization.
keywords: [Excel VBA, fix error 91, Object Variable Not Set, range access, macro debugging]
---

## The Symptom (The Error)

- **Error Code:** Runtime Error 91
- **Error Message:** "Object variable or With block variable not set"
- **The Scenario:** User tries to copy data from one worksheet range to another using VBA, but receives Error 91 when executing the macro.

Here's the problematic code that triggers the error:

```vba
Sub CopyDataBad()
    Dim sourceRange As Range
    Dim targetRange As Range
    
    ' This line causes Runtime Error 91
    sourceRange.Value = targetRange.Value
End Sub
```

## The Root Cause

Runtime Error 91 occurs when code attempts to use an object variable that hasn't been properly initialized. In this case:
1. Both `sourceRange` and `targetRange` are declared but never set to actual Range objects
2. The code tries to use the `.Value` property of uninstantiated objects
3. VBA cannot perform the operation because the object references don't point to valid worksheet ranges


``

## The Solution (Practical Fix)

The corrected code properly initializes the Range objects before use:

```vba
Sub CopyDataFixed()
    Dim sourceRange As Range
    Dim targetRange As Range
    
    ' Set references to actual worksheet ranges
    Set sourceRange = ThisWorkbook.Sheets("Data").Range("A1:A10")
    Set targetRange = ThisWorkbook.Sheets("Report").Range("B1:B10")
    
    ' Now the operation will work
    targetRange.Value = sourceRange.Value
End Sub
```

This solution works because:
1. Both Range variables are properly initialized using the `Set` keyword
2. The code specifies exactly which worksheet each range belongs to
3. Note we also corrected the direction of the copy operation (source â†’ target)

## Prevention

To avoid Runtime Error 91 in similar scenarios:

1. Always use `Set` when assigning object variables
2. Explicitly qualify all worksheet references (don't rely on ActiveSheet)
3. Add error handling to catch unset objects:
   
```vba
If sourceRange Is Nothing Then
    MsgBox "Source range not set!", vbCritical
    Exit Sub
End If
```

4. Use `Option Explicit` to force variable declaration
5. Initialize objects immediately after declaration when possible